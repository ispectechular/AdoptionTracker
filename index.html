<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Adoption Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --blue:#4A7A92; --teal:#5A94B1; --muted:#879B8D; --purple:#756A85; --lilac:#8E869F;
    --light:#C2D6E1; --sage:#A0B4A7; --soft:#D3DDD7; --pale:#C4BFD0;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:'Lexend',sans-serif;
    min-height:100vh; display:flex; align-items:center; justify-content:center;
    background: linear-gradient(120deg, var(--light), var(--soft));
    padding:24px;
  }
  .wrap{
    width:100%; max-width:980px;
    background:rgba(255,255,255,.7); backdrop-filter:blur(10px);
    border-radius:20px; box-shadow:0 10px 20px rgba(0,0,0,.1);
    padding:24px;
  }
  .header{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    margin-bottom:16px;
  }
  .title{
    font-size:2rem; font-weight:700; color:var(--blue);
  }
  .form{
    display:flex; gap:8px; flex-wrap:wrap; align-items:center;
  }
  .form input{
    flex:1 1 360px; padding:12px 14px; border-radius:14px; border:1px solid var(--light);
    background:#fff; outline:none; font-size:1rem;
  }
  .btn{
    padding:12px 16px; border:none; border-radius:14px; cursor:pointer;
    transition: transform .06s ease, box-shadow .2s ease, opacity .2s ease;
    font-weight:700; color:#fff;
    background: linear-gradient(135deg, var(--blue), var(--purple));
    box-shadow:0 6px 14px rgba(0,0,0,.12);
  }
  .btn:hover{ box-shadow:0 10px 22px rgba(0,0,0,.16) }
  .btn:active{ transform:scale(.98) }
  .grid{
    display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:16px;
  }
  .card{
    display:flex; gap:12px; align-items:center;
    background:#fff; border-radius:16px; padding:14px;
    box-shadow:0 6px 14px rgba(0,0,0,.1);
    transition: transform .15s ease, box-shadow .2s ease;
  }
  .card:hover{ transform:translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,.14) }
  .img{
    width:64px; height:64px; border-radius:12px; object-fit:cover; flex:0 0 64px;
    background:var(--soft);
  }
  .meta{ display:flex; flex-direction:column; gap:4px; min-width:0 }
  .name{
    font-weight:700; color:var(--blue); font-size:1.1rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  }
  .name a{ color:inherit; text-decoration:none; }
  .status{
    margin-left:auto; padding:6px 10px; border-radius:999px; font-weight:700; font-size:.9rem;
    display:inline-flex; align-items:center; gap:6px; white-space:nowrap;
  }
  .dot{ width:8px; height:8px; border-radius:50% }
  .available{ background:rgba(135,155,141,.18); color:#2f6b3b; }
  .available .dot{ background:#2f6b3b; }
  .matched{ background:rgba(0,0,0,.08); color:#555; }
  .matched .dot{ background:#555; }
  .row{
    display:flex; align-items:center; gap:12px; width:100%;
  }
  .kill{
    margin-left:auto; background: linear-gradient(135deg, #d9534f, #8E869F);
  }
  .subtle{ color:var(--muted); font-size:.9rem }
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="title">Adoption Tracker</div>
      <form class="form" id="adder">
        <input id="url" type="url" placeholder="Paste Indiana Adoption Program profile URL (e.g., https://www.indianaadoptionprogram.org/profile/jacob-9887/)" required>
        <button class="btn" type="submit">Add Profile</button>
      </form>
    </div>
    <div id="grid" class="grid" aria-live="polite"></div>
    <div class="subtle" id="hint" style="margin-top:10px;"></div>
  </div>

<script>
  // ====== SET THIS TO YOUR APPS SCRIPT WEB APP URL ======
  const GAS_URL = 'PASTE_YOUR_WEB_APP_URL_HERE'; // e.g., https://script.google.com/macros/s/AKfyc.../exec
  // ======================================================

  const grid = document.getElementById('grid');
  const adder = document.getElementById('adder');
  const hint = document.getElementById('hint');

  function statusPill(status){
    const s = (status||'').toLowerCase();
    const cls = s === 'available' ? 'available' : 'matched';
    const label = s === 'available' ? 'Available' : 'Matched';
    return `<span class="status ${cls}"><span class="dot"></span>${label}</span>`;
  }

  function cardHTML(item){
    const safeName = item.name || 'Unknown';
    const image = item.imageUrl || '';
    const url = item.url || '#';
    return `
      <div class="card">
        <img class="img" src="${image}" alt="${safeName}">
        <div class="row">
          <div class="meta">
            <div class="name"><a href="${url}" target="_blank" rel="noopener">${safeName}</a></div>
          </div>
          ${statusPill(item.status)}
          <button class="btn kill" data-url="${url}" title="Remove">Remove</button>
        </div>
      </div>
    `;
  }

  async function fetchList(){
    const res = await fetch(`${GAS_URL}?action=list`, { cache:'no-store' });
    const data = await res.json();
    return data.items || [];
  }

  async function render(){
    hint.textContent = 'Loading...';
    try{
      const items = await fetchList();
      grid.innerHTML = items.map(cardHTML).join('') || '<div class="subtle">No profiles yet. Paste a profile URL to add one.</div>';
      hint.textContent = '';
    }catch(e){
      hint.textContent = 'Could not load the list. Check your Apps Script deployment URL.';
    }
  }

  adder.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const url = document.getElementById('url').value.trim();
    if(!url) return;
    hint.textContent = 'Adding...';
    try{
      await fetch(GAS_URL, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ action:'add', url })
      });
      document.getElementById('url').value = '';
      await render();
      hint.textContent = 'Added.';
    }catch(err){
      hint.textContent = 'Add failed.';
    }
  });

  grid.addEventListener('click', async (e)=>{
    const btn = e.target.closest('.kill');
    if(!btn) return;
    const url = btn.getAttribute('data-url');
    if(!url) return;
    hint.textContent = 'Removing...';
    try{
      await fetch(GAS_URL, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ action:'remove', url })
      });
      await render();
      hint.textContent = 'Removed.';
    }catch(err){
      hint.textContent = 'Remove failed.';
    }
  });

  render();
</script>
</body>
</html>
